<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE-edge">
	<meta id="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
	<script src="https://cdn.bootcss.com/touchjs/0.2.14/touch.js"></script>
	<title>Touch Pic</title>
	<style type="text/css">
		*{
			margin: 0;
			padding: 0;
		}

		#container{
			width: 600px;
			margin: 0 auto;
		}
		.pic{
			width: 100%;
			z-index: 0;
		}
		.fortap{
			transition: all 0.5s ease;
			-webkit-transition: all 0.5s ease;
		}
		.tap{
			display: block;
			position: absolute;
		}
	</style>
	<script src="https://libs.baidu.com/jquery/2.0.0/jquery.js"></script>
</head>
<body>
	<div id="container">
		<img src="image/01.jpg" class="pic" />
	</div>
	<script type="text/javascript">
		//var con = $('pic')[0];
		if (!IsPC()) {
			$('#container').css({
				'width': 50+'%',
				'height': $(window).height(),
			});
		}
		var toScale = $(window).width()/$('#container').width();
		var dx = 0, dy = 0;
		var scaletag = false, initScale = 1, curScale = 0;
		touch.on('.pic', 'touchstart', function(e){
			$(this).removeClass('fortap');
			e.preventDefault();
		});

		touch.on($('.pic'), 'drag', function(e){
			var curx = dx+e.x+'px';
			var cury = dy+e.y+'px';
			//this.style.webkitTransform = 'translate3d(' + curx + ', ' + cury + ', 0)';
			var isScale = '';
			if (scaletag) {
				isScale = 'scale(' + initScale + ',' + initScale + ')';
				$(this).css({
					'webkitTransform': 'translate3d(' + curx + ', ' + cury + ', 0)' + isScale,
				});
			}
		});
		touch.on('.pic', 'dragend', function(e){
			dx += e.x;
			dy += e.y;
		});

		touch.on('.pic', 'tap', function(){
			scaletag = ~scaletag;
			if (!$(this).hasClass('fortap')) {
				$(this).addClass('fortap');
			}

			if(scaletag){
				$('#container').css({
					'position': 'absolute',
					'top': ($(window).height()-$(this).height())/2,
					'left': ($(window).width()-$(this).width())/2,
				});
				$(this).css({
					'webkitTransform': 'scale(' + toScale + ')',
					'zIndex': 1000,
				});
				//$(this).toggleClass('tap');
				initScale = toScale;
			}else{
				$('#container').css({
					'position': 'static',
				});
				dx = 0, dy = 0;
				$(this).css({
					'webkitTransform': 'translate3d(0, 0, 0)' + 'scale(1, 1)',
					'zIndex': 0,
					'position': 'static',
				});
				initScale = 1;
			}
		});

		touch.on('.pic', 'doubletap', function(){
			if (scaletag) {
				if (!$(this).hasClass('fortap')) {
					$(this).addClass('fortap');
				}
				$(this).css({
					'webkitTransform': 'translate3d(' + dx + 'px, ' + dy + 'px, 0)' + 'scale(3, 3)',
					'position': 'absolute',
				});
				initScale = 3;
			}
		});

		touch.on('.pic', 'pinch', function(e){
			curScale = initScale + e.scale - 1;
			if (scaletag) {
				$(this).removeClass('fordoubeltap');
				$(this).css({
					'webkitTransform': 'translate3d(' + dx + 'px, ' + dy + 'px, 0)' + 'scale(' + curScale + ',' + curScale + ')',
					'zIndex': 1000,
				});
			}
		});
		touch.on('.pic', 'pinchend', function(){
			initScale = curScale;
		})

		function IsPC(){  
           var userAgentInfo = navigator.userAgent;  
           var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");  
           var flag = true;  
           for (var v = 0; v < Agents.length; v++) {  
               if (userAgentInfo.indexOf(Agents[v]) > 0) {flag = false; break;}  
           }  
           return flag;  
		} 
	</script>
</body>
</html>